# Внешние вызовы

Триггеры событий после выполнения операции не ограничиваются действиями в пользовательском интерфейсе и могут быть вызваны через HTTP API.

:::info{title="Подсказка"}
При вызове событий после выполнения операции через HTTP API также следует учитывать состояние активации рабочего процесса и соответствие настроек таблицы данных, иначе вызов может не выполниться или возникнуть ошибки.
:::

Для рабочих процессов, локально привязанных к кнопкам действий, можно вызывать их следующим образом (пример с кнопкой, созданной для таблицы `posts`):

```bash
curl -X POST -H 'Authorization: Bearer <your token>' -H 'X-Role: <roleName>' -d \
  '{
    "title": "Hello, world!",
    "content": "This is a test post."
  }'
  "http://localhost:3000/api/posts:create?triggerWorkflows=workflowKey"
```

URL-параметр `triggerWorkflows` содержит ключ рабочего процесса, для нескольких рабочих процессов ключи разделяются запятой. Этот ключ можно получить, наведя мышь на название рабочего процесса в верхней части канвы рабочего процесса:

![Получение ключа рабочего процесса](https://static-docs.nocobase.com/20240426135108.png)

После успешного вызова будет запущено событие после выполнения операции для соответствующей таблицы `posts`.

:::info{title="Подсказка"}
При внешнем вызове также необходимо учитывать авторизацию пользователя, поэтому при вызове через HTTP API необходимо предоставлять аутентификационные данные, такие как заголовок `Authorization` или параметр `token` (токен, полученный при входе) и заголовок `X-Role` (текущая роль пользователя), аналогично запросам, отправляемым из обычного интерфейса.
:::

Если необходимо запустить событие для связанной с одной стороны данных (связь с несколькими сторонами еще не поддерживается), можно использовать символ `!` в параметрах для указания связанного поля данных:

```bash
curl -X POST -H 'Authorization: Bearer <your token>' -H 'X-Role: <roleName>' -d \
  '{
    "title": "Hello, world!",
    "content": "This is a test post.",
    "category": {
      "title": "Test category"
    }
  }'
  "http://localhost:3000/api/posts:create?triggerWorkflows=workflowKey!category"
```

После успешного вызова будет запущено событие после выполнения операции для соответствующей таблицы `categories`.

:::info{title="Подсказка"}
Если событие настроено в глобальном режиме, то использование URL-параметра `triggerWorkflows` для указания соответствующего рабочего процесса не требуется. Достаточно вызвать соответствующую операцию с таблицей данных, чтобы запустить событие.
:::
