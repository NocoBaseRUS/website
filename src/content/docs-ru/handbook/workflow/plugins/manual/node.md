# Ручной узел

## Создание узла

На странице конфигурации рабочего процесса нажмите кнопку плюс ("+") в процессе, чтобы добавить узел "Ручная обработка":

![Создание ручного узла](https://static-docs.nocobase.com/4dd259f1aceeaf9b825abb4b257df909.png)

## Настройка узла

### Ответственный

Ручной узел требует указать пользователя, который будет выполнять задачу из списка "ожидающие". Список задач можно добавить на страницу через блок, а содержимое всплывающего окна задачи для каждого узла настраивается в интерфейсе узла.

Выберите пользователя или используйте переменные для выбора первичного или внешнего ключа данных пользователя из контекста.

![Ручной узел_Настройка_Ответственный_Выбор переменной](https://static-docs.nocobase.com/22fbca3b8e21fda3a831019037001445.png)

:::info{title=Подсказка}
В настоящее время опция ответственного в ручном узле не поддерживает обработку несколькими пользователями. Поддержка будет добавлена в будущих версиях.
:::

### Настройка пользовательского интерфейса

Конфигурация интерфейса задач "ожидающие" является ключевым элементом ручного узла. Нажмите кнопку "Настройка пользовательского интерфейса", чтобы открыть независимую конфигурацию во всплывающем окне. Как и на обычной странице, вы можете настраивать интерфейс в режиме WYSIWYG:

![Ручной узел_Настройка узла_Интерфейс](https://static-docs.nocobase.com/fd360168c879743cf22d57440cd2590f.png)

#### Вкладки

Вкладки могут использоваться для разделения разного контента. Например, одна вкладка может быть предназначена для отправки формы одобрения, другая — для отправки формы отказа или для отображения подробной информации о связанных данных. Возможна свободная настройка.

#### Блоки

Поддерживаемые типы блоков в основном делятся на две категории: блоки данных и блоки форм. Также доступен Markdown, который используется для статического контента, такого как подсказки.

##### Блок данных

Блок данных может использовать данные триггера или результаты обработки любого узла для предоставления ответственному за задачу контекстной информации. Например, если рабочий процесс запускается событием формы, можно создать блок с подробной информацией о данных триггера. Настройка аналогична настройке обычной страницы с деталями: вы можете свободно выбирать поля из данных триггера для отображения:

![Ручной узел_Настройка узла_Интерфейс_Блок данных_Триггер](https://static-docs.nocobase.com/675c3e58a1a4f45db310a72c2d0a404c.png)

Аналогично, блок данных узла позволяет выбрать результаты данных из предыдущих узлов для отображения в деталях. Например, результат вычислительного узла может использоваться как справочная информация для ответственного за задачу:

![Ручной узел_Настройка узла_Интерфейс_Блок данных_Данные узла](https://static-docs.nocobase.com/a583e26e508e954b47e5ddff80d998c4.png)

:::info{title=Подсказка}
Поскольку при конфигурации интерфейса рабочий процесс находится в неактивном состоянии, в блоках данных конкретные данные не отображаются. Данные будут видны только после запуска рабочего процесса и открытия всплывающего окна задачи.
:::

##### Блок формы

В интерфейсе задач "ожидающие" необходимо настроить хотя бы один блок формы, который будет принимать окончательное решение о продолжении выполнения рабочего процесса. Отсутствие формы приведет к невозможности продолжения процесса после его прерывания. Формы бывают трех типов:

- Пользовательская форма
- Форма добавления данных
- Форма обновления данных

![Ручной узел_Настройка узла_Интерфейс_Тип формы](https://static-docs.nocobase.com/2d068f3012ab07e32a265405492104a8.png)

Форма добавления данных и форма обновления данных требуют выбора базовой таблицы данных. После отправки формы пользователем данные из формы будут использованы для создания новой записи или обновления существующей в указанной таблице данных. Пользовательская форма позволяет определить временную форму, не связанную с таблицами данных. Значения полей этой формы после отправки могут быть использованы в последующих узлах.

Кнопки отправки формы можно настроить тремя способами:

- Продолжить процесс после отправки
- Завершить процесс после отправки
- Только сохранить значения формы

![Ручной узел_Настройка узла_Интерфейс_Кнопки формы](https://static-docs.nocobase.com/6b45995b14152e85a821dff6f6e3189a.png)

Три кнопки представляют три состояния узла в процессе обработки: после отправки форма переводит узел в состояние "завершено", "отклонено" или продолжает оставаться в состоянии "ожидание". В форме необходимо настроить хотя бы одну из первых двух кнопок, чтобы определить дальнейшее направление всего рабочего процесса.

На кнопке "Продолжить процесс" можно настроить присвоение значений полям формы:

![Ручной узел_Настройка узла_Интерфейс_Кнопки формы_Установка значений формы](https://static-docs.nocobase.com/2cec2d4e2957f068877e616dec3b56dd.png)

![Ручной узел_Настройка узла_Интерфейс_Кнопки формы_Всплывающее окно установки значений формы](https://static-docs.nocobase.com/5ff51b60c76cdb76e6f1cc95dc3d8640.png)

После открытия всплывающего окна можно назначать значения любым полям формы. После отправки формы эти значения будут использованы как финальные значения полей. Это особенно полезно при проверке данных, когда можно использовать несколько разных кнопок "Продолжить процесс", каждая из которых устанавливает разные перечислимые значения для полей состояния. Таким образом достигается выполнение последующих шагов процесса с использованием различных значений данных.
